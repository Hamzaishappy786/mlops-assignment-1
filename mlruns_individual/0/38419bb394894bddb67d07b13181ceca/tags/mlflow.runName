register_best_model_enhanced